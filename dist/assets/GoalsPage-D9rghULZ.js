import{_ as R,g as A,m as E,r as m,n as I,K as N,c as d,x as V,a as n,t as p,F as j,y as z,j as _,l as y,f as k,i as Y,q as $,k as S,o as g,J as x,w as P,v as K}from"./index-DoOH1WHm.js";import{N as L}from"./TheNavbar-zCnu1AXD.js";const H={class:"content"},J={key:0,class:"loading-message"},Q={key:1,class:"goal-container"},W={class:"total-budget"},X={class:"goal-header"},Z=["value","max"],ee={class:"goal-controls"},te=["onUpdate:modelValue"],se=["onClick"],oe={__name:"GoalsPage",setup(ne){const w=A(),u=E(),r=m(null),a=m({}),l=m({}),h=m(!0),f={Food:500,Transport:200,Shopping:400,Utilities:150,Groceries:300,Others:100},C=I(()=>Object.values(a.value).reduce((t,s)=>t+s,0)),O=(t,s,o)=>{const e=t/s,i={Food:{overspent:"You've overspent on food! Try eating at home more.","near-limit":"You're close to your food budget. Cook more to save!",meeting:"Great job managing your food spending!"},Transport:{overspent:"You've overspent on transport! Try carpooling or cycling.","near-limit":"Almost at your transport limit. Consider fewer trips.",meeting:"Efficient transport usage. Keep it up!"},Utilities:{overspent:"You've overspent on utilities! Reduce AC or light usage.","near-limit":"You're close to your utilities budget. Be mindful of energy use.",meeting:"You're saving well on utilities!"},Shopping:{overspent:"Overspent on shopping! Hold off on impulse buys.","near-limit":"Almost at your shopping limit. Prioritize essentials.",meeting:"Smart shopping this month!"},Groceries:{overspent:"Grocery spending high! Make a list and stick to it.","near-limit":"You're close to your grocery budget. Shop wisely.",meeting:"You're managing groceries well."},Others:{overspent:"Spending too much on miscellaneous items!","near-limit":"Close to the 'Others' budget. Evaluate your needs.",meeting:"Miscellaneous spending under control."},default:{overspent:"You've overspent this month.","near-limit":"You're close to your budget limit.",meeting:"You're on track!"}},c=i[o]||i.default;return t>s?c.overspent:e>=.9?c["near-limit"]:c.meeting},G=(t,s)=>t>s?"exceeded":t>=s*.9?"near-limit":"meeting",T=async()=>{const t=w.currentUser;if(!t)return null;const s=_(u,"users"),o=$(s,S("uid","==",t.uid)),e=await y(o);return e.empty?null:e.docs[0].id},U=async()=>{if(!r.value)return;const t=_(u,"users",r.value,"expenses"),s=new Date,o=s.getFullYear(),e=(s.getMonth()+1).toString().padStart(2,"0"),i=`${o}-${e}-01`,c=`${o}-${e}-31`,F=$(t,S("date",">=",i),S("date","<=",c)),M=await y(F),b={Food:0,Transport:0,Shopping:0,Utilities:0,Groceries:0,Others:0};M.forEach(B=>{const v=B.data();v.category&&v.cost&&(b[v.category]+=v.cost)}),l.value=b},q=async()=>{const t=await T();if(!t)return;r.value=t;const s=_(u,"users",r.value,"spendingGoals"),o=await y(s);if(!o.empty)o.forEach(e=>{a.value[e.id]=e.data().goal});else{a.value={...f};for(const e in f){const i=k(u,"users",r.value,"spendingGoals",e);await Y(i,{goal:f[e]})}}await U(),h.value=!1},D=async t=>{if(!r.value)return;const s=k(u,"users",r.value,"spendingGoals",t);await Y(s,{goal:a.value[t]},{merge:!0}),alert(`Updated ${t} goal to $${a.value[t]}`)};return N(w,async t=>{t?await q():(a.value={},l.value={},h.value=!1)}),(t,s)=>(g(),d("div",null,[V(L),n("div",H,[s[0]||(s[0]=n("h1",null,"Spending Goals Overview",-1)),s[1]||(s[1]=n("p",null,"Customize your spending goals for this month.",-1)),h.value?(g(),d("div",J,"Loading...")):(g(),d("div",Q,[n("div",W,"Total Budget: $"+p(C.value),1),(g(!0),d(j,null,z(a.value,(o,e)=>(g(),d("div",{key:e,class:"goal"},[n("div",X,[n("h3",null,p(e),1),n("p",null,"$"+p(l.value[e]||0)+" / $"+p(o),1)]),n("progress",{value:l.value[e]||0,max:o,class:x(G(l.value[e],o))},null,10,Z),n("div",ee,[P(n("input",{"onUpdate:modelValue":i=>a.value[e]=i,type:"number",min:"0",placeholder:"Set goal"},null,8,te),[[K,a.value[e],void 0,{number:!0}]]),n("button",{onClick:i=>D(e)},"Save",8,se)]),n("div",{class:x([G(l.value[e],o),"goal-status"])},p(O(l.value[e],o,e)),3)]))),128))]))])]))}},re=R(oe,[["__scopeId","data-v-d8c5d148"]]);export{re as default};
