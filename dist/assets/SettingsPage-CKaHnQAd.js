import{_ as W,g as X,m as Z,r as n,p as _,f as v,C as ee,c as o,x as te,a as t,b as u,w as c,v as p,z as g,t as m,B as re,L as se,M as ne,N as oe,j as ae,q as le,k as ue,l as ie,O as de,D as y,u as ve,o as a}from"./index-BLU3K2nf.js";import{N as ce}from"./TheNavbar-psDHII7v.js";const pe={class:"settings-page"},ge={class:"settings-container"},me={class:"settings-options"},ye={key:0,class:"modal-overlay"},fe={class:"modal"},be={class:"modal-buttons"},we={key:1,class:"modal-overlay"},Ce={class:"modal"},Ee={class:"modal-buttons"},ke={key:2,class:"modal-overlay"},Ae={class:"modal"},Ne={class:"modal-buttons"},Ue={key:3,class:"modal-overlay"},Pe={class:"modal"},Se={class:"modal-buttons"},$e={key:4,class:"modal-overlay"},De={class:"modal"},Ve={class:"modal-buttons"},he={key:5,class:"modal-overlay"},Te={class:"modal"},Re={class:"modal-buttons"},xe={key:6,class:"modal-overlay"},Ge={class:"modal"},Fe={class:"modal-buttons"},qe={key:7,class:"modal-overlay"},Me={class:"modal"},Be={class:"modal-buttons"},Ie={__name:"SettingsPage",setup(Oe){const i=X(),d=Z(),E=n(!1),k=n(!1),A=n(!1),N=n(!1),U=n(!1),P=n(!1),S=n(!1),$=n(!1),x=n(""),G=n(""),F=n(""),q=n(""),M=n(""),B=n(""),I=n(""),C=n(""),f=n(""),b=n(""),D=n(""),V=n(""),h=n(""),T=n(""),w=n(""),R=n({});ve(),_(async()=>{try{console.log("Fetching user data...");const r=i.currentUser;if(!r){console.error("No user signed in.");return}console.log("User signed in:",r.uid);const e=v(d,"users",r.uid),s=await ee(e);if(s.exists()){const l=s.data();console.log("User data fetched:",l),R.value=l,x.value=l.username||"",G.value=l.age||"",F.value=l.gender||"",q.value=l.representativeNumber||"",M.value=l.about||"",B.value=l.company||"",I.value=l.savingTarget||""}else console.error("User document does not exist.")}catch(r){console.error("Error fetching user data:",r)}});const O=async()=>{if(!C.value.trim()||C.value.length<6){alert("Password must be at least 6 characters long!");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");if(!r.emailVerified){await se(r),alert("A verification email has been sent to your email address. Please verify it before changing your password.");const e=setInterval(async()=>{await ne(r),r.emailVerified&&(clearInterval(e),alert("Your email has been verified! You can now change your password."))},3e3);return}await oe(r,C.value),alert("Password updated successfully!"),E.value=!1}catch(r){console.error("Error updating password:",r),r.code==="auth/requires-recent-login"?alert("You need to log in again to change your password."):alert("An error occurred. Please try again.")}},Y=async()=>{if(!f.value.trim()){alert("Username cannot be empty");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=ae(d,"users"),s=le(e,ue("username","==",f.value));if(!(await ie(s)).empty){alert("This username is already taken. Please choose another one.");return}await de(r,{displayName:f.value});const Q=v(d,"users",r.uid);await y(Q,{username:f.value}),alert("Username updated successfully!"),k.value=!1}catch(r){console.error("Error updating username:",r),alert("An error occurred. Please try again.")}},j=async()=>{if(!b.value||isNaN(b.value)||b.value<=0){alert("Please enter a valid age");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{age:parseInt(b.value)}),alert("Age updated successfully!"),A.value=!1}catch(r){console.error("Error updating age:",r),alert("An error occurred. Please try again.")}},z=async()=>{if(!D.value.trim()){alert("Please select a gender");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{gender:D.value}),alert("Gender updated successfully!"),N.value=!1}catch(r){console.error("Error updating gender:",r),alert("An error occurred. Please try again.")}},L=async()=>{if(!V.value.trim()){alert("Representative number cannot be empty");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{regNumber:V.value}),alert("Representative number updated successfully!"),U.value=!1}catch(r){console.error("Error updating representative number:",r),alert("An error occurred. Please try again.")}},H=async()=>{if(!h.value.trim()){alert("About cannot be empty");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{about:h.value}),alert("About updated successfully!"),P.value=!1}catch(r){console.error("Error updating about:",r),alert("An error occurred. Please try again.")}},J=async()=>{if(!T.value.trim()){alert("Company cannot be empty");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{company:T.value}),alert("Company updated successfully!"),S.value=!1}catch(r){console.error("Error updating company:",r),alert("An error occurred. Please try again.")}},K=async()=>{if(!w.value||isNaN(w.value)||w.value<=0){alert("Please enter a valid savings target");return}try{const r=i.currentUser;if(!r)throw new Error("No user signed in.");const e=v(d,"users",r.uid);await y(e,{savingTarget:w.value}),alert("Savings Target updated successfully!"),$.value=!1}catch(r){console.error("Error updating savings target:",r),alert("An error occurred. Please try again.")}};return(r,e)=>(a(),o("div",pe,[te(ce),t("div",ge,[e[24]||(e[24]=t("h2",null,"Settings",-1)),t("div",me,[t("button",{onClick:e[0]||(e[0]=s=>E.value=!0)},"Change Password"),t("button",{onClick:e[1]||(e[1]=s=>k.value=!0)},"Edit Username"),t("button",{onClick:e[2]||(e[2]=s=>A.value=!0)},"Edit Age"),t("button",{onClick:e[3]||(e[3]=s=>N.value=!0)},"Edit Gender"),R.value.role==="FA"?(a(),o("button",{key:0,onClick:e[4]||(e[4]=s=>U.value=!0)},"Edit Representative Number")):u("",!0),R.value.role==="FA"?(a(),o("button",{key:1,onClick:e[5]||(e[5]=s=>P.value=!0)},"Edit About")):u("",!0),R.value.role==="FA"?(a(),o("button",{key:2,onClick:e[6]||(e[6]=s=>S.value=!0)},"Edit Company")):(a(),o("button",{key:3,onClick:e[7]||(e[7]=s=>$.value=!0)},"Edit Savings Target"))])]),E.value?(a(),o("div",ye,[t("div",fe,[e[25]||(e[25]=t("h3",null,"Edit Password",-1)),c(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>C.value=s),type:"password",placeholder:"Enter new password"},null,512),[[p,C.value]]),t("div",be,[t("button",{onClick:O},"Save"),t("button",{onClick:e[9]||(e[9]=s=>E.value=!1)},"Cancel")])])])):u("",!0),k.value?(a(),o("div",we,[t("div",Ce,[e[27]||(e[27]=t("h3",null,"Edit Username",-1)),t("p",null,[e[26]||(e[26]=g("Current Username: ")),t("strong",null,m(x.value),1)]),c(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>f.value=s),placeholder:"Enter new username"},null,512),[[p,f.value]]),t("div",Ee,[t("button",{onClick:Y},"Save"),t("button",{onClick:e[11]||(e[11]=s=>k.value=!1)},"Cancel")])])])):u("",!0),A.value?(a(),o("div",ke,[t("div",Ae,[e[29]||(e[29]=t("h3",null,"Edit Age",-1)),t("p",null,[e[28]||(e[28]=g("Current Age: ")),t("strong",null,m(G.value),1)]),c(t("input",{type:"number","onUpdate:modelValue":e[12]||(e[12]=s=>b.value=s),placeholder:"Enter your age"},null,512),[[p,b.value]]),t("div",Ne,[t("button",{onClick:j},"Save"),t("button",{onClick:e[13]||(e[13]=s=>A.value=!1)},"Cancel")])])])):u("",!0),N.value?(a(),o("div",Ue,[t("div",Pe,[e[32]||(e[32]=t("h3",null,"Edit Gender",-1)),t("p",null,[e[30]||(e[30]=g("Current Gender: ")),t("strong",null,m(F.value),1)]),c(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>D.value=s)},e[31]||(e[31]=[t("option",{value:"",disabled:""},"Select your gender",-1),t("option",{value:"Male"},"Male",-1),t("option",{value:"Female"},"Female",-1),t("option",{value:"Other"},"Other",-1)]),512),[[re,D.value]]),t("div",Se,[t("button",{onClick:z},"Save"),t("button",{onClick:e[15]||(e[15]=s=>N.value=!1)},"Cancel")])])])):u("",!0),U.value?(a(),o("div",$e,[t("div",De,[e[34]||(e[34]=t("h3",null,"Edit Representative Number",-1)),t("p",null,[e[33]||(e[33]=g("Current Representative Number: ")),t("strong",null,m(q.value),1)]),c(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>V.value=s),placeholder:"Enter new representative number"},null,512),[[p,V.value]]),t("div",Ve,[t("button",{onClick:L},"Save"),t("button",{onClick:e[17]||(e[17]=s=>U.value=!1)},"Cancel")])])])):u("",!0),P.value?(a(),o("div",he,[t("div",Te,[e[36]||(e[36]=t("h3",null,"Edit About",-1)),t("p",null,[e[35]||(e[35]=g("Current About: ")),t("strong",null,m(M.value),1)]),c(t("textarea",{"onUpdate:modelValue":e[18]||(e[18]=s=>h.value=s),placeholder:"Enter new about"},null,512),[[p,h.value]]),t("div",Re,[t("button",{onClick:H},"Save"),t("button",{onClick:e[19]||(e[19]=s=>P.value=!1)},"Cancel")])])])):u("",!0),S.value?(a(),o("div",xe,[t("div",Ge,[e[38]||(e[38]=t("h3",null,"Edit Company",-1)),t("p",null,[e[37]||(e[37]=g("Current Company: ")),t("strong",null,m(B.value),1)]),c(t("input",{"onUpdate:modelValue":e[20]||(e[20]=s=>T.value=s),placeholder:"Enter new company"},null,512),[[p,T.value]]),t("div",Fe,[t("button",{onClick:J},"Save"),t("button",{onClick:e[21]||(e[21]=s=>S.value=!1)},"Cancel")])])])):u("",!0),$.value?(a(),o("div",qe,[t("div",Me,[e[40]||(e[40]=t("h3",null,"Edit Savings Target",-1)),t("p",null,[e[39]||(e[39]=g("Current Savings Target: ")),t("strong",null,m(I.value),1)]),c(t("input",{"onUpdate:modelValue":e[22]||(e[22]=s=>w.value=s),placeholder:"Enter new savings target"},null,512),[[p,w.value]]),t("div",Be,[t("button",{onClick:K},"Save"),t("button",{onClick:e[23]||(e[23]=s=>$.value=!1)},"Cancel")])])])):u("",!0)]))}},ze=W(Ie,[["__scopeId","data-v-5800f010"]]);export{ze as default};
