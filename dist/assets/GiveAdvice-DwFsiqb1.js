import{_ as S,m as C,g as V,r as s,p as D,c as r,x as N,a as l,w as m,b as B,B as E,F as y,y as G,v as _,J as M,t as h,j as k,l as U,H as I,o as u}from"./index-DUYM3bTQ.js";import{N as L}from"./TheNavbar-DHRFYb2-.js";const T={class:"give-advice-container"},P=["value"],R=["disabled"],j={key:0},z={key:1},H={__name:"GiveAdvice",setup(J){const p=C(),x=V(),o=s(""),i=s(""),f=s([]),d=s(""),b=s(!1),v=s(!1),n=s(""),c=s(!1),A=async()=>{b.value=!0;try{const t=x.currentUser;if(!t)return;const e=k(p,"users",t.uid,"clients"),a=await U(e);f.value=a.docs.map(g=>({uid:g.id,...g.data()}))}catch(t){console.error("Error fetching clients:",t),n.value="Failed to load clients. Please refresh.",c.value=!0}finally{b.value=!1}},w=()=>{o.value="",i.value="",d.value=""},F=async()=>{if(!(!i.value||!o.value.trim())){v.value=!0,n.value="",c.value=!1;try{const t=k(p,"users",i.value,"advice");await I(t,{label:d.value||"General Advice",content:o.value.trim(),timestamp:new Date}),n.value="✔️ Advice successfully submitted!",c.value=!1,w()}catch(t){console.error("Error submitting advice:",t),n.value="❌ Failed to submit advice. Please try again.",c.value=!0}finally{v.value=!1}}};return D(A),(t,e)=>(u(),r(y,null,[N(L),l("div",T,[e[4]||(e[4]=l("h2",null,"Give Financial Advice",-1)),m(l("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>i.value=a),class:"client-dropdown"},[e[3]||(e[3]=l("option",{disabled:"",value:""},"Select a client",-1)),(u(!0),r(y,null,G(f.value,a=>(u(),r("option",{key:a.uid,value:a.uid},h(a.username),9,P))),128))],512),[[E,i.value]]),m(l("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a),placeholder:"Label for this advice (e.g., Investment Strategy)",class:"label-input"},null,512),[[_,d.value]]),m(l("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.value=a),placeholder:"Type your advice here...",rows:"10",class:"advice-textarea"},null,512),[[_,o.value]]),l("button",{onClick:F,class:"submit-btn",disabled:!i.value||!o.value.trim()||v.value},[v.value?(u(),r("span",j,"Submitting...")):(u(),r("span",z,"Submit Advice"))],8,R),n.value?(u(),r("p",{key:0,class:M(["feedback-message",c.value?"error":"success"])},h(n.value),3)):B("",!0)])],64))}},O=S(H,[["__scopeId","data-v-851f1a97"]]);export{O as default};
